
---

title: Neuroglancer
type: docs
---

# Neuroglancer

### Purpose

Neuroglancer is a powerful tool for viewing FIBSEM raw data, as well as labels and predictions generated by deep learning pipelines. Developed by Google, it offers multiple options for visualizing datasets through a web interface, Python API, and command line tools. 

While general usage tutorials are available online, this document will focus on two specific cases:

1. Sharing a Neuroglancer link with volumes stored in AWS.
2. Sharing a Neuroglancer link with volumes located on TK computers.

---

### 1. Sharing a Neuroglancer Link for AWS Volumes

Many of the lab's FIBSEM datasets are publicly available via AWS S3. To share a Neuroglancer link for volumes stored in AWS, follow these steps:

1. **Define Your JSON File**:

   Create a JSON file specifying the dimensions, position, layers, and other parameters. Below is an example JSON configuration:

   ```json
   {
     "dimensions": {
       "z": [5e-9, "m"],
       "y": [5e-9, "m"],
       "x": [5e-9, "m"]
     },
     "position": [
       661.827880859375,
       464.6793212890625,
       1837.700927734375
     ],
     "crossSectionScale": 1,
     "projectionScale": 16384,
     "layers": [
       {
         "type": "image",
         "source": {
           "url": "zarr://s3://asem-project/datasets/cell_6/cell_6.zarr/volumes/raw_equalized_0.02/",
           "transform": {
             "outputDimensions": {
               "z": [5e-9, "m"],
               "y": [5e-9, "m"],
               "x": [5e-9, "m"]
             },
             "inputDimensions": {
               "d0": [5e-9, "m"],
               "d1": [5e-9, "m"],
               "d2": [5e-9, "m"]
             }
           }
         },
         "tab": "source",
         "name": "raw_equalized_0.02"
       }
     ],
     "selectedLayer": {
       "visible": true,
       "layer": "raw_equalized_0.02"
     },
     "layout": "4panel"
   }
   ```

   **Notes**:
   - **dimensions**: Adjust if your data dimensions differ from 5 x 5 x 5 nm.
   - **position**: Sets the starting location of the viewer. Optional to modify.
   - **layers/source/url**: Update to the URL of your AWS S3 data, keeping the `zarr://s3://` prefix.
   - **name**: Define a name for the volume.
   - **selectedLayer/layer**: Update to the layer name defined in your configuration.

2. **Generate the Link**:

   To create and share the link:
   - Copy the JSON content.
   - Append it to the following base URL: `https://neuroglancer-demo.appspot.com/#!`.

   Example link:

   ```
   https://neuroglancer-demo.appspot.com/#!%7B%22dimensions%22:%7B%22z%22:%5B5e-9%2C%22m%22%5D%2C%22y%22:%5B5e-9%2C%22m%22%5D%2C%22x%22:%5B5e-9%2C%22m%22%5D%7D%2C%22position%22:%5B661.827880859375%2C464.6793212890625%2C1837.700927734375%5D%2C%22crossSectionScale%22:1%2C%22projectionScale%22:16384%2C%22layers%22:%5B%7B%22type%22:%22image%22%2C%22source%22:%7B%22url%22:%22zarr://s3://asem-project/datasets/cell_6/cell_6.zarr/volumes/raw_equalized_0.02/%22%2C%22transform%22:%7B%22outputDimensions%22:%7B%22z%22:%5B5e-9%2C%22m%22%5D%2C%22y%22:%5B5e-9%2C%22m%22%5D%2C%22x%22:%5B5e-9%2C%22m%22%5D%7D%2C%22inputDimensions%22:%7B%22d0%22:%5B5e-9%2C%22m%22%5D%2C%22d1%22:%5B5e-9%2C%22m%22%5D%2C%22d2%22:%5B5e-9%2C%22m%22%5D%7D%7D%7D%2C%22tab%22:%22source%22%2C%22name%22:%22raw_equalized_0.02%22%7D%5D%2C%22selectedLayer%22:%7B%22visible%22:true%2C%22layer%22:%22raw_equalized_0.02%22%7D%2C%22layout%22:%224panel%22%7D
   ```

---

### 2. Sharing a Neuroglancer Link for TK Computers

If the volume is located on a TK computer, follow these steps:

1. **Set Up the Docker Environment**:

   - Connect to any DGX or TK Lab machine with Docker installed.
   - Ensure that you have the Docker image `host_publicly`, which is built from the Dockerfile located at `/nfs/tkhome/your_username/Documents/Misc_Scripts/Dockerfile`.

2. **Run the Docker Container**:

   ```bash
   docker run -it --rm --net=host host_publicly
   ```

3. **Configure Neuroglancer for Public Access**:

   - Locate the Neuroglancer executable in your environment with:
     ```bash
     which neuroglancer
     ```

   - Modify the line in the Neuroglancer script:
     ```python
     viewer.set_bind_address()
     ```
     Change it to:
     ```python
     viewer.set_bind_address('0.0.0.0', 8003)
     ```

4. **Stream Neuroglancer Publicly**:

   - To stream Neuroglancer publicly, run the container with ngrok:
     ```bash
     docker run -it --rm --net=host --entrypoint ngrok host_publicly http --domain=perfect-hookworm-carefully.ngrok-free.app <port #>
     ```

   - Make sure your program is running on port 8003.

5. **Access and Share the Link**:

   - Visit the ngrok link provided to view the content from any computer globally.

---


